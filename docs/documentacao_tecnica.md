# Documentacao tecnica do sistema BooK+

## 1. Visao geral
O BooK+ e uma aplicacao web para gestao financeira e administrativa com integracao a planilhas do Google Sheets e geracao de relatorios em PDF. O sistema centraliza lancamentos (entradas e saidas), fornece visoes gerenciais (DRE, fluxo de caixa, fechamento) e apoia rotinas administrativas (tarefas e cadastros).

## 2. Stack e dependencias
### Frontend
- React 18
- React Router
- React Helmet
- Framer Motion
- Radix UI
- Tailwind CSS
- Lucide React
- Recharts

### Backend
- Node.js (ESM)
- Express
- serve-static
- compression

### Integracoes
- Supabase (PostgreSQL + Auth)
- Google Sheets API

### Relatorios
- jsPDF
- jspdf-autotable
- html2canvas

## 3. Estrutura do repositorio
- src/: frontend
  - pages/: paginas principais
  - components/: componentes reutilizaveis
  - services/: integracoes
  - hooks/: hooks de estado
  - lib/: utilitarios
- server/: backend Express
- Documentacao/: documentacao e SQL legacy
- supabase/: scripts auxiliares

## 4. Execucao e scripts
### Scripts npm
- dev: inicia Vite em 127.0.0.1:3000
- build: build do frontend
- preview: preview do build
- start: server Express em producao

### Variaveis de ambiente
Frontend:
- VITE_SUPABASE_URL
- VITE_SUPABASE_ANON_KEY

Backend:
- GOOGLE_API_KEY
- GOOGLE_SHEET_PAGAMENTOS_ID
- GOOGLE_SHEET_RECEBIMENTOS_ID
- NODE_ENV

## 5. Banco de dados (Supabase)
Nao existem migracoes no repositorio. O schema abaixo e inferido pelo uso real no codigo.

### 5.1 Tabela lancamentos
Campos usados no codigo:
- id (PK)
- data (date)
- tipo (Entrada | Saida)
- unidade
- cliente_fornecedor
- descricao
- valor
- status
- obs
- aluno
- parcela
- desc_pontual
- datapag
- contato
- valor_aberto
- cpf_cnpj
- created_at

### 5.2 Tabela postit
Campos usados:
- id (PK)
- tarefa
- data
- concluida (S/N)
- created_at

### 5.3 Tabela clientes_fornecedores
Campos usados:
- id (PK)
- tipo
- descricao
- created_at

### 5.4 Tabela unidades
Campos usados:
- id (PK)
- descricao
- created_at

### 5.5 Scripts SQL sugeridos
```sql
create table if not exists public.lancamentos (
  id bigint generated by default as identity primary key,
  data date not null,
  tipo text not null check (tipo in ('Entrada', 'Saida')),
  unidade text,
  cliente_fornecedor text,
  descricao text,
  valor numeric(12,2) not null default 0,
  status text,
  obs text,
  aluno text,
  parcela text,
  desc_pontual numeric(12,2),
  datapag date,
  contato text,
  valor_aberto numeric(12,2),
  cpf_cnpj text,
  created_at timestamptz not null default now()
);
create index if not exists lancamentos_data_idx on public.lancamentos (data);
create index if not exists lancamentos_tipo_idx on public.lancamentos (tipo);
create index if not exists lancamentos_status_idx on public.lancamentos (status);

create table if not exists public.postit (
  id bigint generated by default as identity primary key,
  tarefa text not null,
  data timestamptz,
  concluida char(1) not null default 'N',
  created_at timestamptz not null default now()
);

create table if not exists public.clientes_fornecedores (
  id bigint generated by default as identity primary key,
  tipo text not null,
  descricao text not null,
  created_at timestamptz not null default now()
);
create index if not exists clientes_fornecedores_tipo_idx on public.clientes_fornecedores (tipo);

create table if not exists public.unidades (
  id bigint generated by default as identity primary key,
  descricao text not null,
  created_at timestamptz not null default now()
);
```

## 6. Backend (Express)
Arquivos principais:
- server/index.js: inicia o servidor, define HOST/PORT.
- server/app.js: cria app Express, configura rotas e serve frontend.

### Rotas backend
- GET /health: retorna { status: ok }.
- POST /api/google-sheets/import: busca dados do Google Sheets.

## 7. Frontend (React)
### Rotas principais
- / selecao de area
- /dashboard (financeiro)
- /administrativo
- /administrativo/tarefas
- /administrativo/relatorios
- /operacional
- /pedagogico
- /relatorios + subrotas
- /cadastros
- /contas-receber
- /contas-pagar
- /fluxo-caixa
- /financeiro
- /financeiro/cadastro
- /lancamentos
- /operacional/integracao

### Autenticacao
- Supabase Auth.
- PrivateRoute protege rotas privadas.

## 8. Processos principais
- Importacao Google Sheets: frontend chama API, converte dados e grava no Supabase.
- Lancamentos: formulario cria/edita registros e suporta recorrencia.
- Contas a pagar/receber: listagem por tipo com baixa manual.
- Relatorios: fechamento, DRE e fluxo com exportacao PDF.
- Administrativo: tarefas (post-it) com CRUD.
- Cadastros: fornecedores e unidades gravados no Supabase.

## 9. Diretrizes de design
- Tema escuro com glass-card.
- Tipografia em branco e cinza.
- Botoes primary azul, outline para secundario.
- Grid responsivo.

### Exemplos de classes utilitarias
- Card: glass-card p-6 border border-white/10 rounded-xl
- Tabela: min-w-full text-sm text-gray-200
- Botao primary: bg-blue-600 hover:bg-blue-700 text-white

## 10. Validacoes finais
- Rotas carregam sem erros.
- Importacao com Google Sheets funcionando.
- Supabase conectado com tabelas descritas.
- Relatorios em PDF gerados corretamente.
